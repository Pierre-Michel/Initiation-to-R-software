---
title: "Initiation to R Software"
author: "Pierre Michel"
date: "Master AMSE 1st year, 2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Problem Set V

## Exercice 1

Consider the following functions:

```{r, echo = T, eval = F}
# Function g
g = function(n,p) {
  mu = n*p
  sigma = sqrt(n*p*(1-p))
  w0 = (0:n-mu)/sigma
  x = c(-3,rep(w0,rep(2,n+1)),3)
  z = rep(c(-1,0:n),rep(2,n+2) )
  y = pbinom(z,n,p)
  l0 = paste("Bin Nor n =",n)
  plot(c(0,0),xlim=c(-3,3),ylim=c(0,1), type="n",xlab=l0,ylab="Proba")
  lines(x,y)
  lines(seq(-3,3,le=100),pnorm(seq(-3,3,le=100)))
}
# Test function g
par(mfrow=c(3,2))
g(3,1/3) 
g(5,1/3) 
g(10,1/3) 
g(20,1/3)
g(50,1/3) 
g(100,1/3)
# Function h
h = function(n,p) {
  mu = n*p;sigma <- sqrt(n*p*(1-p))
  w0 = (0:n-mu)/sigma
  x = c(-3,rep(w0,rep(2,n+1)),3)
  z = rep(c(-1,0:n),rep(2,n+2) )
  y = diff(c(0,pbinom(z,n,p)))
  l0 = paste("Bin Nor n =",n)
  plot(x,y,xlim=c(-3,3),ylim=c(0,1), type="h",xlab=l0,ylab="Proba")
}
# Test function g
par(mfrow=c(3,2))
h(3,1/3) 
h(5,1/3) 
h(10,1/3) 
h(20,1/3)
h(50,1/3) 
h(100,1/3)
```

Describe in details what these functions do.

## Exercice 2

Generate a vector of size 1000 following a normal distribution $\mathcal{N}(15,3)$. Write a function that computes the moving average of size 3 (the mean of three consecutive vector elements) of this vector and plot the corresponding histogram. Then compute the moving average of size 4. Consider the size as a variable parameter.

## Exercice 3

Write a function that writes, with row/column number, only the elements of a correlation matrix that have an absolute value greater than 0.6. Then do the same thing for the value 0.5. Consider this value as a variable parameter. Apply this to the matrix correlation of the *airquality* dataset, obtained using the following commands:

```{r, echo = T}
data(airquality) ;
C = cor(airquality, use="pairwise.complete.obs")
C
```